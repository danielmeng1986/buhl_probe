<div
  class="login-dialog-overlay"
  (click)="onCancel()"
  (keydown.escape)="onCancel()"
  tabindex="0"
>
  <div
    class="login-dialog"
    (click)="$event.stopPropagation()"
    (keydown.enter)="$event.stopPropagation()"
    (keydown.space)="$event.stopPropagation()"
    role="dialog"
    aria-modal="true"
    tabindex="0"
  >
    <div class="dialog-header">
      <h2>{{ "LOGIN.TITLE" | translate }}</h2>
      <button class="close-button" (click)="onCancel()" type="button">
        &times;
      </button>
    </div>

    <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="login-form">
      <div class="form-group">
        <label for="username">{{ "LOGIN.USERNAME" | translate }}</label>
        <input
          id="username"
          type="text"
          formControlName="username"
          [class.error]="username?.invalid && username?.touched"
          placeholder="{{ 'LOGIN.USERNAME_PLACEHOLDER' | translate }}"
        />
        @if (username?.invalid && username?.touched) {
          <div class="error-message">
            @if (username?.errors?.["required"]) {
              <span>{{ "LOGIN.USERNAME_REQUIRED" | translate }}</span>
            }
          </div>
        }
      </div>

      <div class="form-group">
        <label for="password">{{ "LOGIN.PASSWORD" | translate }}</label>
        <input
          id="password"
          type="password"
          formControlName="password"
          [class.error]="password?.invalid && password?.touched"
          placeholder="{{ 'LOGIN.PASSWORD_PLACEHOLDER' | translate }}"
        />
        @if (password?.invalid && password?.touched) {
          <div class="error-message">
            @if (password?.errors?.["required"]) {
              <span>{{ "LOGIN.PASSWORD_REQUIRED" | translate }}</span>
            }
          </div>
        }
      </div>

      @if (errorMessage) {
        <div class="error-message">
          {{ errorMessage | translate }}
        </div>
      }

      <div class="dialog-actions">
        <button
          type="button"
          class="button secondary"
          (click)="onCancel()"
          [disabled]="isLoading"
        >
          {{ "LOGIN.CANCEL" | translate }}
        </button>
        <button
          type="submit"
          class="button primary"
          [disabled]="loginForm.invalid || isLoading"
        >
          @if (isLoading) {
            <span>{{ "LOGIN.LOGGING_IN" | translate }}</span>
          }
          @if (!isLoading) {
            <span>{{ "LOGIN.LOGIN" | translate }}</span>
          }
        </button>
      </div>
    </form>
  </div>
</div>
